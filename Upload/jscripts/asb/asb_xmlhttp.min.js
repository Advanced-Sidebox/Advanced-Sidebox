var ASB=(function(a,$){function SideboxUpdater(container,url,options){this.options=$.extend({},options||{});this.frequency=(this.options.frequency||30);this.decay=this.options.decay=(this.options.decay||1);this.container=$("#"+container).children('tbody');this.options.url=url;this.options.complete=$.proxy(this.updateComplete,this);this.phpTimeDiff=Math.floor(this.options.data.dateline-(new Date().getTime()/1000));this.start();}
function start(){this.timer=setTimeout($.proxy(this.onTimerEvent,this),(this.decay*this.frequency)*1000);}
function stop(){clearTimeout(this.timer);}
function updateComplete(response){if(response.responseText&&response.responseText!='nochange'){this.decay=this.options.decay;this.container.html(response.responseText);}else{this.decay=this.decay*this.options.decay;}
this.options.data.dateline=Math.floor(new Date().getTime()/1000+this.phpTimeDiff);this.timer=setTimeout($.proxy(this.onTimerEvent,this),(this.decay*this.frequency)*1000);}
function onTimerEvent(){if(this.container.width()<=0&&this.container.height()<=0){this.timer=setTimeout($.proxy(this.onTimerEvent,this),(this.decay*this.frequency)*1000);return;}
$.ajax(this.options);}
SideboxUpdater.prototype={start:start,stop:stop,updateComplete:updateComplete,onTimerEvent:onTimerEvent,};function buildUpdaters(updaters,widths,script){if(updaters.length==0){return;}
var this_id='',width=0;for(var i=0;i<updaters.length;i++){this_id=updaters[i].addon+'_main_'+updaters[i].id;if(!$("#"+this_id)){continue;}
width=widths.left;if(updaters[i].position){width=widths.right;}
new SideboxUpdater(this_id,'xmlhttp.php',{type:'get',data:{action:'asb',id:updaters[i].id,addon:updaters[i].addon,dateline:updaters[i].dateline,width:width,script:script,},frequency:updaters[i].rate});}}
a.ajax={buildUpdaters:buildUpdaters,};return a;})(ASB||{},jQuery);